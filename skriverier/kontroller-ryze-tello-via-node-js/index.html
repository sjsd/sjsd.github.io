<!DOCTYPE html>
<html data-html-server-rendered="true" lang="nb" class="h-full" data-vue-tag="class,lang">
  <head>
    <title>Kontroller Ryze Tello via Node.js  | Helge Johnsen</title><meta name="gridsome:hash" content="179440c8d5ee3432a5cbe712c16ac94f9cd52e73"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.3"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" name="yandex-verification" content="ffddc7f095ad060f"><meta data-vue-tag="ssr" name="msvalidate.01" content="8266CD570A96286AF1BA64938A15F43F"><meta data-vue-tag="ssr" name="theme-color" content="#ffffff"><meta data-vue-tag="ssr" name="Sist oppdatert" content="Tue Nov 03 2020 12:10:26 GMT+0100 (GMT+01:00)"><meta data-vue-tag="ssr" data-key="description" name="description" content="I 2017 slo DJI seg sammen med Intel og Ryze Technology og skapte den lille dronen Ryze Tello. Dette er en relativt rimelig drone. Denne lille dronen har mye muskler under panseret som blant annet en SDK som er tilgjengelig via Wi-Fi. I dette innlegget skal jeg presentere en av mange muligheter til å kontrollere dronen ved å bruke Node.js og noen innebygde biblioteket for å sende kommandoer til å styre dronen direkte fra terminalvinduet.

"><meta data-vue-tag="ssr" data-key="strapiId" name="strapiId" content="43"><meta data-vue-tag="ssr" property="og:type" content="article"><meta data-vue-tag="ssr" property="og:title" content="Kontroller Ryze Tello via Node.js"><meta data-vue-tag="ssr" property="og:description" content="I 2017 slo DJI seg sammen med Intel og Ryze Technology og skapte den lille dronen Ryze Tello. Dette er en relativt rimelig drone. Denne lille dronen har mye muskler under panseret som blant annet en SDK som er tilgjengelig via Wi-Fi. I dette innlegget skal jeg presentere en av mange muligheter til å kontrollere dronen ved å bruke Node.js og noen innebygde biblioteket for å sende kommandoer til å styre dronen direkte fra terminalvinduet.

"><meta data-vue-tag="ssr" property="og:url" content="https://www.helgejohnsen.no/skriverier/kontroller-ryze-tello-via-node-js/"><meta data-vue-tag="ssr" property="article:published_time" content="2020-09-17"><meta data-vue-tag="ssr" property="og:image" content="https://res.cloudinary.com/sjsd/image/upload/c_scale,q_60,w_896/ozo7uhxqigqpwoatv1wt"><meta data-vue-tag="ssr" property="og:locale" content="nb_NO"><meta data-vue-tag="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-tag="ssr" name="twitter:title" content="Kontroller Ryze Tello via Node.js"><meta data-vue-tag="ssr" name="twitter:description" content="I 2017 slo DJI seg sammen med Intel og Ryze Technology og skapte den lille dronen Ryze Tello. Dette er en relativt rimelig drone. Denne lille dronen har mye muskler under panseret som blant annet en SDK som er tilgjengelig via Wi-Fi. I dette innlegget skal jeg presentere en av mange muligheter til å kontrollere dronen ved å bruke Node.js og noen innebygde biblioteket for å sende kommandoer til å styre dronen direkte fra terminalvinduet.

"><meta data-vue-tag="ssr" name="twitter:site" content="@sjsd"><meta data-vue-tag="ssr" name="twitter:creator" content="@sjsd"><meta data-vue-tag="ssr" name="twitter:image" content="https://res.cloudinary.com/sjsd/image/upload/c_scale,q_60,w_896/ozo7uhxqigqpwoatv1wt"><link data-vue-tag="ssr" rel="preconnect" href="//fonts.googleapis.com"><link data-vue-tag="ssr" rel="dns-prefetch" href="//www.google-analytics.com"><link data-vue-tag="ssr" rel="dns-prefetch" href="//res.cloudinary.com"><link data-vue-tag="ssr" rel="preconnect" href="https://fonts.gstatic.com" crossorgin=""><link data-vue-tag="ssr" rel="preconnect" href="https://ajax.googleapis.com"><link data-vue-tag="ssr" rel="me" href="https://github.com/sjsd"><link data-vue-tag="ssr" rel="author" href="/humans.txt"><link data-vue-tag="ssr" rel="canonical" href="https://www.helgejohnsen.no/skriverier/kontroller-ryze-tello-via-node-js/"><script data-vue-tag="ssr" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.helgejohnsen.no"},"sameAs":["https://www.linkedin.com/in/helgejohnsen/","https://twitter.com/sjsd","https://www.instagram.com/sjsd/"],"author":{"@type":"Person","name":"Helge Johnsen"},"editor":"Helge Johnsen","publisher":{"@type":"Organization","name":"Helge Johnsen","logo":{"@type":"ImageObject","url":"https://helgejohnsen.no/android-chrome-512x512.png"}},"headline":"Kontroller Ryze Tello via Node.js","description":"I 2017 slo DJI seg sammen med Intel og Ryze Technology og skapte den lille dronen Ryze Tello. Dette er en relativt rimelig drone. Denne lille dronen har mye muskler under panseret som blant annet en SDK som er tilgjengelig via Wi-Fi. I dette innlegget skal jeg presentere en av mange muligheter til å kontrollere dronen ved å bruke Node.js og noen innebygde biblioteket for å sende kommandoer til å styre dronen direkte fra terminalvinduet.\n\n","datePublished":"2020-09-15T21:02:31+02:00","dateCreated":"2020-09-15T21:02:31+02:00","dateModified":"2020-09-16T11:56:19+02:00","image":"https://res.cloudinary.com/sjsd/image/upload/c_scale,q_60,w_896/ozo7uhxqigqpwoatv1wt","url":"https://www.helgejohnsen.no/skriverier/kontroller-ryze-tello-via-node-js/","alternativeHeadline":"Fly drone via terminalen"}</script><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript><link rel="preload" href="/assets/css/12.styles.0b08b74c.css" as="style"><link rel="preload" href="/assets/js/app.d4f856d0.js" as="script"><link rel="preload" href="/assets/js/page--src--templates--blog-posts-vue.c22ddf38.js" as="script"><link rel="prefetch" href="/assets/js/1.864c4d1f.js"><link rel="prefetch" href="/assets/js/page--src--pages--404-vue.3edd8c4f.js"><link rel="prefetch" href="/assets/js/page--src--pages--arbeid-vue.3d311821.js"><link rel="prefetch" href="/assets/js/page--src--pages--index-vue.469ab2ff.js"><link rel="prefetch" href="/assets/js/page--src--pages--kontakt-vue.3ea1af60.js"><link rel="prefetch" href="/assets/js/page--src--pages--om-vue.20574a15.js"><link rel="prefetch" href="/assets/js/page--src--pages--skriverier-vue.7fc0777d.js"><link rel="prefetch" href="/assets/js/page--src--pages--youtube-vue.ffa5d814.js"><link rel="prefetch" href="/assets/js/page--src--templates--portfolios-vue.70bdec81.js"><link rel="prefetch" href="/assets/js/vendors~page--src--pages--arbeid-vue~page--src--pages--index-vue~page--src--pages--skriverier-vue~pa~ebe6a1e9.18f0d60c.js"><link rel="stylesheet" href="/assets/css/12.styles.0b08b74c.css">
  </head>
  <body class="antialiased font-serif" data-vue-tag="class">
    <div data-server-rendered="true" id="app"><main><header><div class="pt-20 py-8 sm:py-24"><div class="max-w-xl md:max-w-3xl xl:max-w-4xl mx-auto text-center px-6"><h1 class="text-3xl sm:text-5xl leading-tight font-sans font-bold mb-2 text-black">
          Kontroller Ryze Tello via Node.js
          <span class="sm:text-4xl text-2xl font-normal block">Fly drone via terminalen</span></h1><p class="text-gray-700"><time class="capitalize">17. september, 2020</time></p></div></div><div class="max-w-xl md:max-w-3xl xl:max-w-4xl mx-auto text-center mb-8 sm:mb-24"><img src="https://res.cloudinary.com/sjsd/image/upload/c_scale,q_60,w_896/ozo7uhxqigqpwoatv1wt" alt="Kontroller Ryze Tello via Node.js" class="inline-block"></div><nav class="absolute top-0 left-0 z-20 mt-6 ml-6"><a href="/skriverier/" class="text-sm border opacity-75 hover:opacity-100 rounded-full px-4 py-2 transition-opacity active">← Les flere skriverier</a></nav></header><article class="max-w-xl md:max-w-2xl xl:max-w-3xl mx-auto px-6 sm:px-12 pb-8 sm:pb-24"><!----><p class="text-gray-700 font-bold text-xl mb-10">
        I 2017 slo DJI seg sammen med Intel og Ryze Technology og skapte den lille dronen Ryze Tello. Dette er en relativt rimelig drone. Denne lille dronen har mye muskler under panseret som blant annet en SDK som er tilgjengelig via Wi-Fi. I dette innlegget skal jeg presentere en av mange muligheter til å kontrollere dronen ved å bruke Node.js og noen innebygde biblioteket for å sende kommandoer til å styre dronen direkte fra terminalvinduet.


      </p><div class="markdown text-lg leading-normal text-gray-700"><p>Jeg vil nok anbefale at du har litt kunnskap om bruke av terminal og JavaScript før du setter i gang. Sett bort ifra det mest åpenbare (en datamaskin og dronen) så trenger du <a href="https://www.npmjs.com/get-npm">Node og NPM installert</a> på din datamaskin. Jeg bruker også to bibliotek som følger med Node.js som heter <em>dgram</em> og <em>readline</em>. I tillegg kan det være greit å kjenne til kommandoene man kan sende til dronen. De er listet opp i <a href="https://dl-cdn.ryzerobotics.com/downloads/tello/0228/Tello+SDK+Readme.pdf">Tello sin SDK (PDF-fil)</a>.</p>
<h2>Import</h2>
<p>Vi trenger to av Node.js sine innebygde bibliotek. Dette gjør koden vår i stand til å sende kommandoene via UDP.</p>
<pre><code>const dgram = require('dgram');
const readline = require('readline');
</code></pre>
<h2>Tilkobling</h2>
<p>Dronen har sitt eget Wi-Fi -nettverk. Før vi kjører koden så må datamaskinen være tilkoblet dette nettverket. Som nevnt i Tello sin SDK så har den følgende IP-adresse og port som vi kobler oss til.</p>
<pre><code>const HOST = '192.168.10.1';
const PORT = 8889;
const client = dgram.createSocket('udp4');
client.bind(PORT);
</code></pre>
<h2>Send en kommando</h2>
<p>Vi lager oss en funksjon som lar oss sende en kommando til dronen. Funksjonen kobler seg til IP-adressen og porten. Komandoene er strenger, derfor kan vi skrive funksjonen slik:</p>
<pre><code>function sendCommand(command) {
    client.send(command, 0, command.length, PORT, HOST, (err, bytes) =&gt; {
        if (err) throw err;
        console.log(`En kommando er sendt til ${HOST}:${PORT}`);
    });
}
</code></pre>
<h2>Få svar</h2>
<p>Når vi sender en kommando til dronen så kan den svare tilbake. F.eks. hvis man sender <em>battery?</em> så kan dronen svare med hvor mye strøm det er igjen på batteriet. Denne koden lytter etter meldinger fra dronen og skriver det ut i terminalen.</p>
<pre><code>client.on('message', (message) =&gt; {
    console.log(message);
});
</code></pre>
<h2>Kommando</h2>
<p>Nå stå vi ved et veiskille. Enten kan du hardkode og sende kommandoer til dronen eller du kan lytte etter det som skrives inn i terminalvinduet for å sende det som en kommando.</p>
<p>F.eks. kan vi spørre om batteriet ved å legge til:</p>
<pre><code>sendCommand('battery?');
</code></pre>
<p>Førstnevnte er kanskje en idé om man skal fly dronen helt likt hver gang. Men sistnevnte er langt mer praktisk og lar en sende kommandoer til dronen. Så vi fjerner den forrige linjen og erstatter den med følgende kode som lar oss lytte etter kommandoer skrevet inn i terminalen.</p>
<pre><code>const rline = readline.createInterface({
    input: process.stdin,
    output: process.stdout,
});

(function input() {
    rline.question('Skriv inn kommando:  ', (command) =&gt; {
      if (command === 'exit') {
        rline.close();
      } else {
        sendCommand(command);
        input();
      }
    });
  }());
</code></pre>
<h2>Hele koden</h2>
<p>Nå har jeg gått igjennom blokk for blokk i koden. Her er den endelige koden i sin helhet.</p>
<pre><code>const dgram = require('dgram');
const readline = require('readline');

const PORT = 8889;
const HOST = '192.168.10.1';

const client = dgram.createSocket('udp4');
client.bind(PORT);

const rline = readline.createInterface({
  input: process.stdin,
  output: process.stdout,
});


function sendCommand(command) {
  client.send(command, 0, command.length, PORT, HOST, (err, bytes) =&gt; {
    if (err) throw err;
    console.log(`En kommando er sendt til ${HOST}:${PORT}`);
  });
}

client.on('message', (message) =&gt; {
  console.log(message);
});


(function userInput() {
  rline.question('Skriv inn kommando:  ', (command) =&gt; {
    if (command === 'exit') {
      rl.close();
    } else {
      sendCommand(command);
      userInput();
    }
  });
}());
</code></pre>
<p>Som du ser så krever det ikke mangel linjer kode for å koble seg til dronen. Det er kanskje ikke så veldig praktisk å skrive inn komandoer på denne måten når man normalt sett kan bruke mobiltelefonen til å kontrollere den. Men det er en proof of consept som viser hva som er mulig å få til. Enten man bruker Node.js slik som jeg har gjort her eller andre språk.</p>
</div><!----></article><footer class="text-gray-700 text-sm leading-normal flex flex-wrap justify-between mx-auto max-w-3xl px-6 sm:px-12 pb-8 sm:pb-10"><div class="w-full sm:w-1/2 mb-4 sm:mb-0"><a href="/" title="Helge Johnsen" class="font-sans font-bold text-3xl">
        Helge Johnsen
      </a></div><div class="w-full sm:w-1/2"><nav><ul class="flex sm:justify-end -mx-2 mt-3"><li class="px-2"><a href="/" class="border-b border-transparent hover:border-gray-400 transition-border-color active">Hjem</a></li><li class="px-2"><a href="/skriverier/" class="border-b border-transparent hover:border-gray-400 transition-border-color active">Skriverier</a></li><li class="px-2"><a href="/om/" class="border-b border-transparent hover:border-gray-400 transition-border-color">Om</a></li><li class="px-2"><a href="/kontakt/" class="border-b border-transparent hover:border-gray-400 transition-border-color">Kontakt</a></li></ul></nav></div><div class="w-full text-center mt-10 mb-4 sm:mb-0"><p>Design basert på <a href="https://github.com/cossssmin/gridsome-starter-bleda" class="border-b border-transparent hover:border-gray-400 transition-border-color">Bleda</a> av <a href="https://twitter.com/cossssmin" class="border-b border-transparent hover:border-gray-400 transition-border-color">@cossssmin</a></p><p>Bygget med <a href="https://gridsome.org" class="border-b border-transparent hover:border-gray-400 transition-border-color">Gridsome</a> &amp; <a href="https://tailwindcss.com/" class="border-b border-transparent hover:border-gray-400 transition-border-color">Tailwind CSS</a>.</p><p><a href="http://one.me/noarghat" title="Få 110,- i avslag på hostingpakke hos One.com" target="_blank" rel="nofollow noopener noreferrer">Få 110,- avslag på hostingpakke hos One.com</a></p></div></footer></main></div>
    <script>window.__INITIAL_STATE__={"data":{"blogPosts":{"id":"43","title":"Kontroller Ryze Tello via Node.js","subtitle":"Fly drone via terminalen","abstract":"I 2017 slo DJI seg sammen med Intel og Ryze Technology og skapte den lille dronen Ryze Tello. Dette er en relativt rimelig drone. Denne lille dronen har mye muskler under panseret som blant annet en SDK som er tilgjengelig via Wi-Fi. I dette innlegget skal jeg presentere en av mange muligheter til å kontrollere dronen ved å bruke Node.js og noen innebygde biblioteket for å sende kommandoer til å styre dronen direkte fra terminalvinduet.\n\n","bodytext":"\u003Cp\u003EJeg vil nok anbefale at du har litt kunnskap om bruke av terminal og JavaScript før du setter i gang. Sett bort ifra det mest åpenbare (en datamaskin og dronen) så trenger du \u003Ca href=\"https:\u002F\u002Fwww.npmjs.com\u002Fget-npm\"\u003ENode og NPM installert\u003C\u002Fa\u003E på din datamaskin. Jeg bruker også to bibliotek som følger med Node.js som heter \u003Cem\u003Edgram\u003C\u002Fem\u003E og \u003Cem\u003Ereadline\u003C\u002Fem\u003E. I tillegg kan det være greit å kjenne til kommandoene man kan sende til dronen. De er listet opp i \u003Ca href=\"https:\u002F\u002Fdl-cdn.ryzerobotics.com\u002Fdownloads\u002Ftello\u002F0228\u002FTello+SDK+Readme.pdf\"\u003ETello sin SDK (PDF-fil)\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\n\u003Ch2\u003EImport\u003C\u002Fh2\u003E\n\u003Cp\u003EVi trenger to av Node.js sine innebygde bibliotek. Dette gjør koden vår i stand til å sende kommandoene via UDP.\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003Econst dgram = require('dgram');\nconst readline = require('readline');\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch2\u003ETilkobling\u003C\u002Fh2\u003E\n\u003Cp\u003EDronen har sitt eget Wi-Fi -nettverk. Før vi kjører koden så må datamaskinen være tilkoblet dette nettverket. Som nevnt i Tello sin SDK så har den følgende IP-adresse og port som vi kobler oss til.\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003Econst HOST = '192.168.10.1';\nconst PORT = 8889;\nconst client = dgram.createSocket('udp4');\nclient.bind(PORT);\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch2\u003ESend en kommando\u003C\u002Fh2\u003E\n\u003Cp\u003EVi lager oss en funksjon som lar oss sende en kommando til dronen. Funksjonen kobler seg til IP-adressen og porten. Komandoene er strenger, derfor kan vi skrive funksjonen slik:\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003Efunction sendCommand(command) {\n    client.send(command, 0, command.length, PORT, HOST, (err, bytes) =&gt; {\n        if (err) throw err;\n        console.log(`En kommando er sendt til ${HOST}:${PORT}`);\n    });\n}\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch2\u003EFå svar\u003C\u002Fh2\u003E\n\u003Cp\u003ENår vi sender en kommando til dronen så kan den svare tilbake. F.eks. hvis man sender \u003Cem\u003Ebattery?\u003C\u002Fem\u003E så kan dronen svare med hvor mye strøm det er igjen på batteriet. Denne koden lytter etter meldinger fra dronen og skriver det ut i terminalen.\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003Eclient.on('message', (message) =&gt; {\n    console.log(message);\n});\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch2\u003EKommando\u003C\u002Fh2\u003E\n\u003Cp\u003ENå stå vi ved et veiskille. Enten kan du hardkode og sende kommandoer til dronen eller du kan lytte etter det som skrives inn i terminalvinduet for å sende det som en kommando.\u003C\u002Fp\u003E\n\u003Cp\u003EF.eks. kan vi spørre om batteriet ved å legge til:\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003EsendCommand('battery?');\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EFørstnevnte er kanskje en idé om man skal fly dronen helt likt hver gang. Men sistnevnte er langt mer praktisk og lar en sende kommandoer til dronen. Så vi fjerner den forrige linjen og erstatter den med følgende kode som lar oss lytte etter kommandoer skrevet inn i terminalen.\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003Econst rline = readline.createInterface({\n    input: process.stdin,\n    output: process.stdout,\n});\n\n(function input() {\n    rline.question('Skriv inn kommando:  ', (command) =&gt; {\n      if (command === 'exit') {\n        rline.close();\n      } else {\n        sendCommand(command);\n        input();\n      }\n    });\n  }());\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Ch2\u003EHele koden\u003C\u002Fh2\u003E\n\u003Cp\u003ENå har jeg gått igjennom blokk for blokk i koden. Her er den endelige koden i sin helhet.\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode\u003Econst dgram = require('dgram');\nconst readline = require('readline');\n\nconst PORT = 8889;\nconst HOST = '192.168.10.1';\n\nconst client = dgram.createSocket('udp4');\nclient.bind(PORT);\n\nconst rline = readline.createInterface({\n  input: process.stdin,\n  output: process.stdout,\n});\n\n\nfunction sendCommand(command) {\n  client.send(command, 0, command.length, PORT, HOST, (err, bytes) =&gt; {\n    if (err) throw err;\n    console.log(`En kommando er sendt til ${HOST}:${PORT}`);\n  });\n}\n\nclient.on('message', (message) =&gt; {\n  console.log(message);\n});\n\n\n(function userInput() {\n  rline.question('Skriv inn kommando:  ', (command) =&gt; {\n    if (command === 'exit') {\n      rl.close();\n    } else {\n      sendCommand(command);\n      userInput();\n    }\n  });\n}());\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003ESom du ser så krever det ikke mangel linjer kode for å koble seg til dronen. Det er kanskje ikke så veldig praktisk å skrive inn komandoer på denne måten når man normalt sett kan bruke mobiltelefonen til å kontrollere den. Men det er en proof of consept som viser hva som er mulig å få til. Enten man bruker Node.js slik som jeg har gjort her eller andre språk.\u003C\u002Fp\u003E\n","image":"https:\u002F\u002Fres.cloudinary.com\u002Fsjsd\u002Fimage\u002Fupload\u002Fc_scale,q_60,w_896\u002Fozo7uhxqigqpwoatv1wt","youtube":"","externalUrl":"","created_at":1600196551640,"updated_at":1600250179671,"path":"\u002Fskriverier\u002Fkontroller-ryze-tello-via-node-js\u002F","date":"2020-09-17 17:02:31","source":"","sourceAsCanonical":null}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/assets/js/app.d4f856d0.js" defer></script><script src="/assets/js/page--src--templates--blog-posts-vue.c22ddf38.js" defer></script><script data-vue-tag="ssr" type="text/javascript" data-body="true">WebFontConfig = {google: { families: [ 'Fira+Sans:400,700|Cardo' ] }};(function() {var wf = document.createElement('script');wf.src = 'https://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';wf.type = 'text/javascript';wf.async = 'true';var s = document.getElementsByTagName('script')[0];s.parentNode.insertBefore(wf, s);})();</script>
  </body>
</html>
